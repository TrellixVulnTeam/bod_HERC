from ast import Return
import asyncio
import os
import aiohttp
from scrape_service.wikidata import get_q, sprql_wikidata, wikidata_linked
from service.service import add_P_mach_url, do_callback_url_mach
from uitls.web_wehsite import url_add2
from uitls.bar import manager

get_Qs = """
SELECT  ?item ?itemLabel ?ID WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }
  ?item wdt:%s ?ID.
}
LIMIT 100
"""
get_QO = """
SELECT ?item  WHERE { ?item wdt:%s ?ID. }
"""
get_Q = """
SELECT ?item  ?ID WHERE {
    SERVICE wikibase:label {bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en".}
    ?item wdt:%s ?ID.
}
"""
P_1 = """
    SELECT ?Wikidata_property ?type_of_Wikidata_propertyLabel WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }
  ?Wikidata_property wdt:P31 wd:%s.
}
 """
P_url_format = """
SELECT ?Wikidata_property ?Wikidata_propertyLabel ?URL_match_pattern WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }
  ?Wikidata_property wdt:P31 wd:%s;
    wdt:P1630 ?URL_match_pattern.
}
 """
P_url_URL_match_pattern = """
SELECT ?Wikidata_property ?Wikidata_propertyLabel ?formatter_URL ?URL_match_pattern WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }
  ?Wikidata_property wdt:P31 wd:%s.
  ?Wikidata_property wdt:P8966 ?URL_match_pattern.
}
 """
Qs = [
    {"Q": "Q18608359", "type": "unknown", "isURL": False},
    {"Q": "Q18608756", "type": "unknown", "isURL": False},
    {"Q": "Q18608871", "type": "unknown", "isURL": False},
    {"Q": "Q18608993", "type": "unknown", "isURL": False},
    {"Q": "Q18609040", "type": "unknown", "isURL": False},
    {"Q": "Q18610173", "type": "unknown", "isURL": False},
    {"Q": "Q18614948", "type": "unknown", "isURL": False},
    {"Q": "Q18615777", "type": "unknown", "isURL": False},
    {"Q": "Q18616084", "type": "unknown", "isURL": False},
    {"Q": "Q18618628", "type": "unknown", "isURL": False},
    {"Q": "Q18618644", "type": "unknown", "isURL": False},
    {"Q": "Q18635217", "type": "unknown", "isURL": False},
    {"Q": "Q18636219", "type": "unknown", "isURL": False},
    {"Q": "Q18636233", "type": "unknown", "isURL": False},
    {"Q": "Q18644427", "type": "unknown", "isURL": False},
    {"Q": "Q18647515", "type": "unknown", "isURL": False},
    {"Q": "Q18647519", "type": "unknown", "isURL": False},
    {"Q": "Q18667213", "type": "unknown", "isURL": False},
    {"Q": "Q18668171", "type": "unknown", "isURL": False},
    {"Q": "Q19595382", "type": "unknown", "isURL": False},
    {"Q": "Q19820110", "type": "unknown", "isURL": False},
    {"Q": "Q19829908", "type": "unknown", "isURL": False},
    {"Q": "Q19829914", "type": "unknown", "isURL": False},
    {"Q": "Q19833377", "type": "unknown", "isURL": False},
    {"Q": "Q19833835", "type": "unknown", "isURL": False},
    {"Q": "Q19847637", "type": "unknown", "isURL": False},
    {"Q": "Q19858569", "type": "unknown", "isURL": False},
    {"Q": "Q19887775", "type": "unknown", "isURL": False},
    {"Q": "Q20085670", "type": "unknown", "isURL": False},
    {"Q": "Q20824104", "type": "unknown", "isURL": False},
    {"Q": "Q21077852", "type": "unknown", "isURL": False},
    {"Q": "Q21099935", "type": "unknown", "isURL": False},
    {"Q": "Q21126229", "type": "unknown", "isURL": False},
    {"Q": "Q21264328", "type": "unknown", "isURL": False},
    {"Q": "Q21294996", "type": "unknown", "isURL": False},
    {"Q": "Q21451142", "type": "unknown", "isURL": False},
    {"Q": "Q21451178", "type": "unknown", "isURL": False},
    {"Q": "Q21504947", "type": "unknown", "isURL": False},
    {"Q": "Q21745557", "type": "unknown", "isURL": False},
    {"Q": "Q21818626", "type": "unknown", "isURL": False},
    {"Q": "Q22582645", "type": "unknown", "isURL": False},
    {"Q": "Q22661913", "type": "unknown", "isURL": False},
    {"Q": "Q22963600", "type": "unknown", "isURL": False},
    {"Q": "Q22964093", "type": "unknown", "isURL": False},
    {"Q": "Q22964126", "type": "unknown", "isURL": False},
    {"Q": "Q22964231", "type": "unknown", "isURL": False},
    {"Q": "Q22964274", "type": "unknown", "isURL": False},
    {"Q": "Q22964288", "type": "unknown", "isURL": False},
    {"Q": "Q22964357", "type": "unknown", "isURL": False},
    {"Q": "Q22964372", "type": "unknown", "isURL": False},
    {"Q": "Q22964476", "type": "unknown", "isURL": False},
    {"Q": "Q22964785", "type": "unknown", "isURL": False},
    {"Q": "Q22964818", "type": "unknown", "isURL": False},
    {"Q": "Q22964966", "type": "unknown", "isURL": False},
    {"Q": "Q22965162", "type": "unknown", "isURL": False},
    {"Q": "Q22969167", "type": "unknown", "isURL": False},
    {"Q": "Q22969221", "type": "unknown", "isURL": False},
    {"Q": "Q22969262", "type": "unknown", "isURL": False},
    {"Q": "Q22981316", "type": "unknown", "isURL": False},
    {"Q": "Q22983697", "type": "unknown", "isURL": False},
    {"Q": "Q22984363", "type": "unknown", "isURL": False},
    {"Q": "Q22984450", "type": "unknown", "isURL": False},
    {"Q": "Q22984475", "type": "unknown", "isURL": False},
    {"Q": "Q22984494", "type": "unknown", "isURL": False},
    {"Q": "Q22984512", "type": "unknown", "isURL": False},
    {"Q": "Q22984545", "type": "unknown", "isURL": False},
    {"Q": "Q22988603", "type": "unknown", "isURL": False},
    {"Q": "Q22988631", "type": "unknown", "isURL": False},
    {"Q": "Q22988651", "type": "unknown", "isURL": False},
    {"Q": "Q22997934", "type": "unknown", "isURL": False},
    {"Q": "Q23038310", "type": "unknown", "isURL": False},
    {"Q": "Q23069609", "type": "unknown", "isURL": False},
    {"Q": "Q23069616", "type": "unknown", "isURL": False},
    {"Q": "Q23310071", "type": "unknown", "isURL": False},
    {"Q": "Q23660994", "type": "unknown", "isURL": False},
    {"Q": "Q23661205", "type": "unknown", "isURL": False},
    {"Q": "Q23673786", "type": "unknown", "isURL": False},
    {"Q": "Q23779665", "type": "unknown", "isURL": False},
    {"Q": "Q24041613", "type": "unknown", "isURL": False},
    {"Q": "Q24041622", "type": "unknown", "isURL": False},
    {"Q": "Q24041781", "type": "unknown", "isURL": False},
    {"Q": "Q24043375", "type": "unknown", "isURL": False},
    {"Q": "Q24052406", "type": "unknown", "isURL": False},
    {"Q": "Q24075706", "type": "unknown", "isURL": False},
    {"Q": "Q24239898", "type": "unknown", "isURL": False},
    {"Q": "Q24262056", "type": "unknown", "isURL": False},
    {"Q": "Q24514938", "type": "unknown", "isURL": False},
    {"Q": "Q24575337", "type": "unknown", "isURL": False},
    {"Q": "Q24710760", "type": "unknown", "isURL": False},
    {"Q": "Q24716199", "type": "unknown", "isURL": False},
    {"Q": "Q24755874", "type": "unknown", "isURL": False},
    {"Q": "Q26235166", "type": "unknown", "isURL": False},
    {"Q": "Q26696664", "type": "unknown", "isURL": False},
    {"Q": "Q26883022", "type": "unknown", "isURL": False},
    {"Q": "Q26935994", "type": "unknown", "isURL": False},
    {"Q": "Q26940804", "type": "unknown", "isURL": False},
    {"Q": "Q27038669", "type": "unknown", "isURL": False},
    {"Q": "Q27048688", "type": "unknown", "isURL": False},
    {"Q": "Q27151329", "type": "unknown", "isURL": False},
    {"Q": "Q27525351", "type": "unknown", "isURL": False},
    {"Q": "Q27642681", "type": "unknown", "isURL": False},
    {"Q": "Q27659414", "type": "unknown", "isURL": False},
    {"Q": "Q27698571", "type": "unknown", "isURL": False},
    {"Q": "Q27870307", "type": "unknown", "isURL": False},
    {"Q": "Q27886949", "type": "unknown", "isURL": False},
    {"Q": "Q27918607", "type": "unknown", "isURL": False},
    {"Q": "Q27968522", "type": "unknown", "isURL": False},
    {"Q": "Q28100241", "type": "unknown", "isURL": False},
    {"Q": "Q28100549", "type": "unknown", "isURL": False},
    {"Q": "Q28104992", "type": "unknown", "isURL": False},
    {"Q": "Q28106456", "type": "unknown", "isURL": False},
    {"Q": "Q28106485", "type": "unknown", "isURL": False},
    {"Q": "Q28106586", "type": "unknown", "isURL": False},
    {"Q": "Q28146956", "type": "unknown", "isURL": False},
    {"Q": "Q28147643", "type": "unknown", "isURL": False},
    {"Q": "Q28326730", "type": "unknown", "isURL": False},
    {"Q": "Q28464773", "type": "unknown", "isURL": False},
    {"Q": "Q28549561", "type": "unknown", "isURL": False},
    {"Q": "Q28600002", "type": "unknown", "isURL": False},
    {"Q": "Q28606291", "type": "unknown", "isURL": False},
    {"Q": "Q28648960", "type": "unknown", "isURL": False},
    {"Q": "Q28648966", "type": "unknown", "isURL": False},
    {"Q": "Q28649017", "type": "unknown", "isURL": False},
    {"Q": "Q28649019", "type": "unknown", "isURL": False},
    {"Q": "Q28649023", "type": "unknown", "isURL": False},
    {"Q": "Q28649030", "type": "unknown", "isURL": False},
    {"Q": "Q28739677", "type": "unknown", "isURL": False},
    {"Q": "Q28746712", "type": "unknown", "isURL": False},
    {"Q": "Q28762481", "type": "unknown", "isURL": False},
    {"Q": "Q28772038", "type": "unknown", "isURL": False},
    {"Q": "Q28772046", "type": "unknown", "isURL": False},
    {"Q": "Q28878279", "type": "unknown", "isURL": False},
    {"Q": "Q28902389", "type": "unknown", "isURL": False},
    {"Q": "Q28916621", "type": "unknown", "isURL": False},
    {"Q": "Q28919033", "type": "unknown", "isURL": False},
    {"Q": "Q29110152", "type": "unknown", "isURL": False},
    {"Q": "Q29446361", "type": "unknown", "isURL": False},
    {"Q": "Q29542094", "type": "unknown", "isURL": False},
    {"Q": "Q29546443", "type": "unknown", "isURL": False},
    {"Q": "Q29546563", "type": "unknown", "isURL": False},
    {"Q": "Q29547399", "type": "unknown", "isURL": False},
    {"Q": "Q29548341", "type": "unknown", "isURL": False},
    {"Q": "Q29561722", "type": "unknown", "isURL": False},
    {"Q": "Q29642812", "type": "unknown", "isURL": False},
    {"Q": "Q29868164", "type": "unknown", "isURL": False},
    {"Q": "Q29887391", "type": "unknown", "isURL": False},
    {"Q": "Q29963999", "type": "unknown", "isURL": False},
    {"Q": "Q30025373", "type": "unknown", "isURL": False},
    {"Q": "Q30041186", "type": "unknown", "isURL": False},
    {"Q": "Q30225604", "type": "unknown", "isURL": False},
    {"Q": "Q30225619", "type": "unknown", "isURL": False},
    {"Q": "Q30249126", "type": "unknown", "isURL": False},
    {"Q": "Q41583306", "type": "unknown", "isURL": False},
    {"Q": "Q41600015", "type": "unknown", "isURL": False},
    {"Q": "Q41657848", "type": "unknown", "isURL": False},
    {"Q": "Q41693989", "type": "unknown", "isURL": False},
    {"Q": "Q41791933", "type": "unknown", "isURL": False},
    {"Q": "Q41799791", "type": "unknown", "isURL": False},
    {"Q": "Q41804262", "type": "unknown", "isURL": False},
    {"Q": "Q42255152", "type": "unknown", "isURL": False},
    {"Q": "Q42396390", "type": "unknown", "isURL": False},
    {"Q": "Q42415497", "type": "unknown", "isURL": False},
    {"Q": "Q42415644", "type": "unknown", "isURL": False},
    {"Q": "Q42428050", "type": "unknown", "isURL": False},
    {"Q": "Q42428442", "type": "unknown", "isURL": False},
    {"Q": "Q42428590", "type": "unknown", "isURL": False},
    {"Q": "Q42752243", "type": "unknown", "isURL": False},
    {"Q": "Q42752262", "type": "unknown", "isURL": False},
    {"Q": "Q43544041", "type": "unknown", "isURL": False},
    {"Q": "Q43546017", "type": "unknown", "isURL": False},
    {"Q": "Q43831109", "type": "unknown", "isURL": False},
    {"Q": "Q44606430", "type": "unknown", "isURL": False},
    {"Q": "Q44606558", "type": "unknown", "isURL": False},
    {"Q": "Q44847669", "type": "unknown", "isURL": False},
    {"Q": "Q45312863", "type": "unknown", "isURL": False},
    {"Q": "Q45484922", "type": "unknown", "isURL": False},
    {"Q": "Q45818495", "type": "unknown", "isURL": False},
    {"Q": "Q46246642", "type": "unknown", "isURL": False},
    {"Q": "Q46275839", "type": "unknown", "isURL": False},
    {"Q": "Q46641179", "type": "unknown", "isURL": False},
    {"Q": "Q46895781", "type": "unknown", "isURL": False},
    {"Q": "Q47512165", "type": "unknown", "isURL": False},
    {"Q": "Q48710051", "type": "unknown", "isURL": False},
    {"Q": "Q50361974", "type": "unknown", "isURL": False},
    {"Q": "Q50362259", "type": "unknown", "isURL": False},
    {"Q": "Q51077473", "type": "unknown", "isURL": False},
    {"Q": "Q51077484", "type": "unknown", "isURL": False},
    {"Q": "Q51089849", "type": "unknown", "isURL": False},
    {"Q": "Q51092447", "type": "unknown", "isURL": False},
    {"Q": "Q51092639", "type": "unknown", "isURL": False},
    {"Q": "Q51118703", "type": "unknown", "isURL": False},
    {"Q": "Q51118821", "type": "unknown", "isURL": False},
    {"Q": "Q51121942", "type": "unknown", "isURL": False},
    {"Q": "Q51122237", "type": "unknown", "isURL": False},
    {"Q": "Q51122921", "type": "unknown", "isURL": False},
    {"Q": "Q51124294", "type": "unknown", "isURL": False},
    {"Q": "Q51326087", "type": "unknown", "isURL": False},
    {"Q": "Q51920440", "type": "unknown", "isURL": False},
    {"Q": "Q52063969", "type": "unknown", "isURL": False},
    {"Q": "Q52425722", "type": "unknown", "isURL": False},
    {"Q": "Q52431918", "type": "unknown", "isURL": False},
    {"Q": "Q52511956", "type": "unknown", "isURL": False},
    {"Q": "Q52513243", "type": "unknown", "isURL": False},
    {"Q": "Q52514469", "type": "unknown", "isURL": False},
    {"Q": "Q53671196", "type": "unknown", "isURL": False},
    {"Q": "Q54076056", "type": "unknown", "isURL": False},
    {"Q": "Q54254515", "type": "unknown", "isURL": False},
    {"Q": "Q54275221", "type": "unknown", "isURL": False},
    {"Q": "Q54275340", "type": "unknown", "isURL": False},
    {"Q": "Q54290695", "type": "unknown", "isURL": False},
    {"Q": "Q54835335", "type": "unknown", "isURL": False},
    {"Q": "Q55082570", "type": "unknown", "isURL": False},
    {"Q": "Q55116891", "type": "unknown", "isURL": False},
    {"Q": "Q55192982", "type": "unknown", "isURL": False},
    {"Q": "Q55452870", "type": "unknown", "isURL": False},
    {"Q": "Q55586529", "type": "unknown", "isURL": False},
    {"Q": "Q55650689", "type": "unknown", "isURL": False},
    {"Q": "Q55653847", "type": "unknown", "isURL": False},
    {"Q": "Q55663163", "type": "unknown", "isURL": False},
    {"Q": "Q55663533", "type": "unknown", "isURL": False},
    {"Q": "Q55977691", "type": "unknown", "isURL": False},
    {"Q": "Q55977774", "type": "unknown", "isURL": False},
    {"Q": "Q55978235", "type": "unknown", "isURL": False},
    {"Q": "Q55978503", "type": "unknown", "isURL": False},
    {"Q": "Q55978551", "type": "unknown", "isURL": False},
    {"Q": "Q55999460", "type": "unknown", "isURL": False},
    {"Q": "Q56150830", "type": "unknown", "isURL": False},
    {"Q": "Q56216056", "type": "unknown", "isURL": False},
    {"Q": "Q56216473", "type": "unknown", "isURL": False},
    {"Q": "Q56245078", "type": "unknown", "isURL": False},
    {"Q": "Q56248867", "type": "unknown", "isURL": False},
    {"Q": "Q56248884", "type": "unknown", "isURL": False},
    {"Q": "Q56248906", "type": "unknown", "isURL": False},
    {"Q": "Q56249073", "type": "unknown", "isURL": False},
    {"Q": "Q56249389", "type": "unknown", "isURL": False},
    {"Q": "Q56457408", "type": "unknown", "isURL": False},
    {"Q": "Q56505345", "type": "unknown", "isURL": False},
    {"Q": "Q56682212", "type": "unknown", "isURL": False},
    {"Q": "Q57589544", "type": "unknown", "isURL": False},
    {"Q": "Q57633168", "type": "unknown", "isURL": False},
    {"Q": "Q57955292", "type": "unknown", "isURL": False},
    {"Q": "Q57980177", "type": "unknown", "isURL": False},
    {"Q": "Q58788038", "type": "unknown", "isURL": False},
    {"Q": "Q59284180", "type": "unknown", "isURL": False},
    {"Q": "Q59910380", "type": "unknown", "isURL": False},
    {"Q": "Q60457486", "type": "unknown", "isURL": False},
    {"Q": "Q60464703", "type": "unknown", "isURL": False},
    {"Q": "Q61052867", "type": "unknown", "isURL": False},
    {"Q": "Q61058429", "type": "unknown", "isURL": False},
    {"Q": "Q61996910", "type": "unknown", "isURL": False},
    {"Q": "Q62036945", "type": "unknown", "isURL": False},
    {"Q": "Q62589316", "type": "unknown", "isURL": False},
    {"Q": "Q62589320", "type": "unknown", "isURL": False},
    {"Q": "Q62606615", "type": "unknown", "isURL": False},
    {"Q": "Q62619638", "type": "unknown", "isURL": False},
    {"Q": "Q63870987", "type": "unknown", "isURL": False},
    {"Q": "Q63871189", "type": "unknown", "isURL": False},
    {"Q": "Q63871233", "type": "unknown", "isURL": False},
    {"Q": "Q63871246", "type": "unknown", "isURL": False},
    {"Q": "Q63871467", "type": "unknown", "isURL": False},
    {"Q": "Q63873112", "type": "unknown", "isURL": False},
    {"Q": "Q64025170", "type": "unknown", "isURL": False},
    {"Q": "Q64169925", "type": "unknown", "isURL": False},
    {"Q": "Q64221137", "type": "unknown", "isURL": False},
    {"Q": "Q64263681", "type": "unknown", "isURL": False},
    {"Q": "Q64264420", "type": "unknown", "isURL": False},
    {"Q": "Q64289010", "type": "unknown", "isURL": False},
    {"Q": "Q64291027", "type": "unknown", "isURL": False},
    {"Q": "Q64292415", "type": "unknown", "isURL": False},
    {"Q": "Q64293728", "type": "unknown", "isURL": False},
    {"Q": "Q64295974", "type": "unknown", "isURL": False},
    {"Q": "Q64348848", "type": "unknown", "isURL": False},
    {"Q": "Q64349017", "type": "unknown", "isURL": False},
    {"Q": "Q64354299", "type": "unknown", "isURL": False},
    {"Q": "Q64620662", "type": "unknown", "isURL": False},
    {"Q": "Q64620663", "type": "unknown", "isURL": False},
    {"Q": "Q64742143", "type": "unknown", "isURL": False},
    {"Q": "Q64746292", "type": "unknown", "isURL": False},
    {"Q": "Q64764172", "type": "unknown", "isURL": False},
    {"Q": "Q64830420", "type": "unknown", "isURL": False},
    {"Q": "Q64846109", "type": "unknown", "isURL": False},
    {"Q": "Q65016292", "type": "unknown", "isURL": False},
    {"Q": "Q65096064", "type": "unknown", "isURL": False},
    {"Q": "Q65947561", "type": "unknown", "isURL": False},
    {"Q": "Q65947656", "type": "unknown", "isURL": False},
    {"Q": "Q66116613", "type": "unknown", "isURL": False},
    {"Q": "Q66116658", "type": "unknown", "isURL": False},
    {"Q": "Q66116790", "type": "unknown", "isURL": False},
    {"Q": "Q66117735", "type": "unknown", "isURL": False},
    {"Q": "Q66117915", "type": "unknown", "isURL": False},
    {"Q": "Q66118123", "type": "unknown", "isURL": False},
    {"Q": "Q66118361", "type": "unknown", "isURL": False},
    {"Q": "Q66118387", "type": "unknown", "isURL": False},
    {"Q": "Q66118402", "type": "unknown", "isURL": False},
    {"Q": "Q66125160", "type": "unknown", "isURL": False},
    {"Q": "Q66125161", "type": "unknown", "isURL": False},
    {"Q": "Q66125187", "type": "unknown", "isURL": False},
    {"Q": "Q66266927", "type": "unknown", "isURL": False},
    {"Q": "Q66309381", "type": "unknown", "isURL": False},
    {"Q": "Q66386615", "type": "unknown", "isURL": False},
    {"Q": "Q66480643", "type": "unknown", "isURL": False},
    {"Q": "Q66626337", "type": "unknown", "isURL": False},
    {"Q": "Q66712599", "type": "unknown", "isURL": False},
    {"Q": "Q66728614", "type": "unknown", "isURL": False},
    {"Q": "Q67042573", "type": "unknown", "isURL": False},
    {"Q": "Q67155279", "type": "unknown", "isURL": False},
    {"Q": "Q67198839", "type": "unknown", "isURL": False},
    {"Q": "Q67205850", "type": "unknown", "isURL": False},
    {"Q": "Q67527144", "type": "unknown", "isURL": False},
    {"Q": "Q68573177", "type": "unknown", "isURL": False},
    {"Q": "Q70564278", "type": "unknown", "isURL": False},
    {"Q": "Q71866636", "type": "unknown", "isURL": False},
    {"Q": "Q73688627", "type": "unknown", "isURL": False},
    {"Q": "Q74568206", "type": "unknown", "isURL": False},
    {"Q": "Q77585243", "type": "unknown", "isURL": False},
    {"Q": "Q78685053", "type": "unknown", "isURL": False},
    {"Q": "Q79967257", "type": "unknown", "isURL": False},
    {"Q": "Q80447536", "type": "unknown", "isURL": False},
    {"Q": "Q80491580", "type": "unknown", "isURL": False},
    {"Q": "Q80840868", "type": "unknown", "isURL": False},
    {"Q": "Q84574746", "type": "unknown", "isURL": False},
    {"Q": "Q84612171", "type": "unknown", "isURL": False},
    {"Q": "Q84612312", "type": "unknown", "isURL": False},
    {"Q": "Q84764641", "type": "unknown", "isURL": True},
    {"Q": "Q87668706", "type": "unknown", "isURL": False},
    {"Q": "Q88206155", "type": "unknown", "isURL": False},
    {"Q": "Q89209418", "type": "unknown", "isURL": False},
    {"Q": "Q89560413", "type": "unknown", "isURL": False},
    {"Q": "Q89566422", "type": "unknown", "isURL": False},
    {"Q": "Q89604788", "type": "unknown", "isURL": False},
    {"Q": "Q93433126", "type": "unknown", "isURL": False},
    {"Q": "Q93436926", "type": "unknown", "isURL": False},
    {"Q": "Q95388829", "type": "unknown", "isURL": False},
    {"Q": "Q95388859", "type": "unknown", "isURL": False},
    {"Q": "Q96192295", "type": "unknown", "isURL": False},
    {"Q": "Q96533552", "type": "unknown", "isURL": False},
    {"Q": "Q96776953", "type": "unknown", "isURL": False},
    {"Q": "Q97584729", "type": "unknown", "isURL": False},
    {"Q": "Q97892178", "type": "unknown", "isURL": False},
    {"Q": "Q98929163", "type": "unknown", "isURL": False},
    {"Q": "Q99192940", "type": "unknown", "isURL": False},
    {"Q": "Q99543626", "type": "unknown", "isURL": False},
    {"Q": "Q99566281", "type": "unknown", "isURL": False},
    {"Q": "Q99566538", "type": "unknown", "isURL": False},
    {"Q": "Q99567026", "type": "unknown", "isURL": False},
    {"Q": "Q99567847", "type": "unknown", "isURL": False},
    {"Q": "Q100391350", "type": "unknown", "isURL": False},
    {"Q": "Q100698536", "type": "unknown", "isURL": False},
    {"Q": "Q101081817", "type": "unknown", "isURL": False},
    {"Q": "Q101083593", "type": "unknown", "isURL": False},
    {"Q": "Q102046040", "type": "unknown", "isURL": False},
    {"Q": "Q102348160", "type": "unknown", "isURL": False},
    {"Q": "Q102357699", "type": "unknown", "isURL": False},
    {"Q": "Q103824108", "type": "unknown", "isURL": False},
    {"Q": "Q103979805", "type": "unknown", "isURL": False},
    {"Q": "Q104245263", "type": "unknown", "isURL": False},
    {"Q": "Q104775940", "type": "unknown", "isURL": False},
    {"Q": "Q105208489", "type": "unknown", "isURL": False},
    {"Q": "Q105208518", "type": "unknown", "isURL": False},
    {"Q": "Q105208538", "type": "unknown", "isURL": False},
    {"Q": "Q105269280", "type": "unknown", "isURL": False},
    {"Q": "Q105271279", "type": "unknown", "isURL": False},
    {"Q": "Q105271307", "type": "unknown", "isURL": False},
    {"Q": "Q105388954", "type": "unknown", "isURL": False},
    {"Q": "Q105406680", "type": "unknown", "isURL": False},
    {"Q": "Q105407800", "type": "unknown", "isURL": False},
    {"Q": "Q105672006", "type": "unknown", "isURL": False},
    {"Q": "Q105946994", "type": "unknown", "isURL": False},
    {"Q": "Q105999567", "type": "unknown", "isURL": False},
    {"Q": "Q105999586", "type": "unknown", "isURL": False},
    {"Q": "Q105999661", "type": "unknown", "isURL": False},
    {"Q": "Q106035765", "type": "unknown", "isURL": False},
    {"Q": "Q106360873", "type": "unknown", "isURL": False},
    {"Q": "Q106623077", "type": "unknown", "isURL": False},
    {"Q": "Q106646822", "type": "unknown", "isURL": False},
    {"Q": "Q106653189", "type": "unknown", "isURL": False},
    {"Q": "Q106666993", "type": "unknown", "isURL": False},
    {"Q": "Q106702532", "type": "unknown", "isURL": False},
    {"Q": "Q106827312", "type": "unknown", "isURL": False},
    {"Q": "Q106839109", "type": "unknown", "isURL": False},
    {"Q": "Q107095360", "type": "unknown", "isURL": False},
    {"Q": "Q107156662", "type": "unknown", "isURL": False},
    {"Q": "Q107211056", "type": "unknown", "isURL": False},
    {"Q": "Q107211254", "type": "unknown", "isURL": False},
    {"Q": "Q107212108", "type": "unknown", "isURL": False},
    {"Q": "Q107223679", "type": "unknown", "isURL": False},
    {"Q": "Q107235145", "type": "unknown", "isURL": False},
    {"Q": "Q107296498", "type": "unknown", "isURL": False},
    {"Q": "Q107316787", "type": "unknown", "isURL": False},
    {"Q": "Q107337221", "type": "unknown", "isURL": False},
    {"Q": "Q107338616", "type": "unknown", "isURL": False},
    {"Q": "Q107363328", "type": "unknown", "isURL": False},
    {"Q": "Q107395292", "type": "unknown", "isURL": False},
    {"Q": "Q107417492", "type": "unknown", "isURL": False},
    {"Q": "Q107417519", "type": "unknown", "isURL": False},
    {"Q": "Q107417524", "type": "unknown", "isURL": False},
    {"Q": "Q107417545", "type": "unknown", "isURL": False},
    {"Q": "Q107417554", "type": "unknown", "isURL": False},
    {"Q": "Q107543330", "type": "unknown", "isURL": False},
    {"Q": "Q107642906", "type": "unknown", "isURL": False},
    {"Q": "Q107642927", "type": "unknown", "isURL": False},
    {"Q": "Q107642929", "type": "unknown", "isURL": False},
    {"Q": "Q107644726", "type": "unknown", "isURL": False},
    {"Q": "Q107644775", "type": "unknown", "isURL": False},
    {"Q": "Q107708380", "type": "unknown", "isURL": False},
    {"Q": "Q107737561", "type": "unknown", "isURL": False},
    {"Q": "Q107737592", "type": "unknown", "isURL": False},
    {"Q": "Q107737623", "type": "unknown", "isURL": False},
    {"Q": "Q107737660", "type": "unknown", "isURL": False},
    {"Q": "Q107737723", "type": "unknown", "isURL": False},
    {"Q": "Q107737736", "type": "unknown", "isURL": False},
    {"Q": "Q107737764", "type": "unknown", "isURL": False},
    {"Q": "Q107737889", "type": "unknown", "isURL": False},
    {"Q": "Q107738007", "type": "unknown", "isURL": False},
    {"Q": "Q107738470", "type": "unknown", "isURL": False},
    {"Q": "Q107738475", "type": "unknown", "isURL": False},
    {"Q": "Q107738583", "type": "unknown", "isURL": False},
    {"Q": "Q107738607", "type": "unknown", "isURL": False},
    {"Q": "Q107741786", "type": "unknown", "isURL": False},
    {"Q": "Q107741870", "type": "unknown", "isURL": False},
    {"Q": "Q107741883", "type": "unknown", "isURL": False},
    {"Q": "Q107741921", "type": "unknown", "isURL": False},
    {"Q": "Q107742145", "type": "unknown", "isURL": False},
    {"Q": "Q107742398", "type": "unknown", "isURL": False},
    {"Q": "Q107743640", "type": "unknown", "isURL": False},
    {"Q": "Q107743712", "type": "unknown", "isURL": False},
    {"Q": "Q107744144", "type": "unknown", "isURL": False},
    {"Q": "Q107745776", "type": "unknown", "isURL": False},
    {"Q": "Q107745801", "type": "unknown", "isURL": False},
    {"Q": "Q107745820", "type": "unknown", "isURL": False},
    {"Q": "Q107745858", "type": "unknown", "isURL": False},
    {"Q": "Q107745868", "type": "unknown", "isURL": False},
    {"Q": "Q107745973", "type": "unknown", "isURL": False},
    {"Q": "Q107746008", "type": "unknown", "isURL": False},
    {"Q": "Q107746027", "type": "unknown", "isURL": False},
    {"Q": "Q107746047", "type": "unknown", "isURL": False},
    {"Q": "Q107746165", "type": "unknown", "isURL": False},
    {"Q": "Q107746173", "type": "unknown", "isURL": False},
    {"Q": "Q107746239", "type": "unknown", "isURL": False},
    {"Q": "Q107746240", "type": "unknown", "isURL": False},
    {"Q": "Q107746241", "type": "unknown", "isURL": False},
    {"Q": "Q107746242", "type": "unknown", "isURL": False},
    {"Q": "Q107746735", "type": "unknown", "isURL": False},
    {"Q": "Q107746736", "type": "unknown", "isURL": False},
    {"Q": "Q107746737", "type": "unknown", "isURL": False},
    {"Q": "Q107746738", "type": "unknown", "isURL": False},
    {"Q": "Q107746739", "type": "unknown", "isURL": False},
    {"Q": "Q107746740", "type": "unknown", "isURL": False},
    {"Q": "Q107746741", "type": "unknown", "isURL": False},
    {"Q": "Q107746742", "type": "unknown", "isURL": False},
    {"Q": "Q107746743", "type": "unknown", "isURL": False},
    {"Q": "Q107746745", "type": "unknown", "isURL": False},
    {"Q": "Q107746746", "type": "unknown", "isURL": False},
    {"Q": "Q107746747", "type": "unknown", "isURL": False},
    {"Q": "Q107746748", "type": "unknown", "isURL": False},
    {"Q": "Q107746777", "type": "unknown", "isURL": False},
    {"Q": "Q107773598", "type": "unknown", "isURL": False},
    {"Q": "Q107773599", "type": "unknown", "isURL": False},
    {"Q": "Q107773600", "type": "unknown", "isURL": False},
    {"Q": "Q107773601", "type": "unknown", "isURL": False},
    {"Q": "Q107773602", "type": "unknown", "isURL": False},
    {"Q": "Q107773603", "type": "unknown", "isURL": False},
    {"Q": "Q107773604", "type": "unknown", "isURL": False},
    {"Q": "Q107773605", "type": "unknown", "isURL": False},
    {"Q": "Q107773608", "type": "unknown", "isURL": False},
    {"Q": "Q107773609", "type": "unknown", "isURL": False},
    {"Q": "Q107773610", "type": "unknown", "isURL": False},
    {"Q": "Q107773611", "type": "unknown", "isURL": False},
    {"Q": "Q107773612", "type": "unknown", "isURL": False},
    {"Q": "Q107773613", "type": "unknown", "isURL": False},
    {"Q": "Q107773614", "type": "unknown", "isURL": False},
    {"Q": "Q107773615", "type": "unknown", "isURL": False},
    {"Q": "Q107773616", "type": "unknown", "isURL": False},
    {"Q": "Q107773617", "type": "unknown", "isURL": False},
    {"Q": "Q107773618", "type": "unknown", "isURL": False},
    {"Q": "Q107773619", "type": "unknown", "isURL": False},
    {"Q": "Q107773620", "type": "unknown", "isURL": False},
    {"Q": "Q107773621", "type": "unknown", "isURL": False},
    {"Q": "Q107782650", "type": "unknown", "isURL": False},
    {"Q": "Q107782652", "type": "unknown", "isURL": False},
    {"Q": "Q107782653", "type": "unknown", "isURL": False},
    {"Q": "Q107782654", "type": "unknown", "isURL": False},
    {"Q": "Q107782655", "type": "unknown", "isURL": False},
    {"Q": "Q107782656", "type": "unknown", "isURL": False},
    {"Q": "Q107782657", "type": "unknown", "isURL": False},
    {"Q": "Q107782660", "type": "unknown", "isURL": False},
    {"Q": "Q107782661", "type": "unknown", "isURL": False},
    {"Q": "Q107782662", "type": "unknown", "isURL": False},
    {"Q": "Q107782663", "type": "unknown", "isURL": False},
    {"Q": "Q107782665", "type": "unknown", "isURL": False},
    {"Q": "Q107782667", "type": "unknown", "isURL": False},
    {"Q": "Q107784814", "type": "unknown", "isURL": False},
    {"Q": "Q107784819", "type": "unknown", "isURL": False},
    {"Q": "Q107784822", "type": "unknown", "isURL": False},
    {"Q": "Q107785090", "type": "unknown", "isURL": False},
    {"Q": "Q107785163", "type": "unknown", "isURL": False},
    {"Q": "Q107785166", "type": "unknown", "isURL": False},
    {"Q": "Q107785208", "type": "unknown", "isURL": False},
    {"Q": "Q107785224", "type": "unknown", "isURL": False},
    {"Q": "Q107785691", "type": "unknown", "isURL": False},
    {"Q": "Q107786704", "type": "unknown", "isURL": False},
    {"Q": "Q108075891", "type": "unknown", "isURL": False},
    {"Q": "Q108079839", "type": "unknown", "isURL": False},
    {"Q": "Q108129010", "type": "unknown", "isURL": False},
    {"Q": "Q108157902", "type": "unknown", "isURL": False},
    {"Q": "Q108530243", "type": "unknown", "isURL": False},
    {"Q": "Q108566342", "type": "unknown", "isURL": False},
    {"Q": "Q108765768", "type": "unknown", "isURL": False},
    {"Q": "Q108884050", "type": "unknown", "isURL": False},
    {"Q": "Q108914651", "type": "unknown", "isURL": False},
    {"Q": "Q108951239", "type": "unknown", "isURL": False},
    {"Q": "Q109142653", "type": "unknown", "isURL": False},
    {"Q": "Q109622131", "type": "unknown", "isURL": False},
    {"Q": "Q109745748", "type": "unknown", "isURL": False},
    {"Q": "Q110232456", "type": "unknown", "isURL": False},
    {"Q": "Q110551506", "type": "unknown", "isURL": False},
    {"Q": "Q110560778", "type": "unknown", "isURL": False},
    {"Q": "Q110682839", "type": "unknown", "isURL": False},
    {"Q": "Q110933724", "type": "unknown", "isURL": False},
    {"Q": "Q110968482", "type": "unknown", "isURL": False},
    {"Q": "Q110972950", "type": "unknown", "isURL": False},
    {"Q": "Q111034486", "type": "unknown", "isURL": False},
    {"Q": "Q111219622", "type": "unknown", "isURL": False},
    {"Q": "Q111219676", "type": "unknown", "isURL": False},
    {"Q": "Q111249673", "type": "unknown", "isURL": False},
    {"Q": "Q111280427", "type": "unknown", "isURL": False},
    {"Q": "Q111339506", "type": "unknown", "isURL": False},
    {"Q": "Q111339517", "type": "unknown", "isURL": False},
    {"Q": "Q111437445", "type": "unknown", "isURL": False},
    {"Q": "Q111445221", "type": "unknown", "isURL": False},
    {"Q": "Q111481605", "type": "unknown", "isURL": False},
    {"Q": "Q111488707", "type": "unknown", "isURL": False},
    {"Q": "Q111603853", "type": "unknown", "isURL": False},
]


def C_query():
    for i in Qs:
        yield i["Q"], P_1 % (i["Q"]), i["isURL"], None
        yield i["Q"], P_url_format % (i["Q"]), i["isURL"], "URL_match_pattern"
        yield i["Q"], P_url_URL_match_pattern % (i["Q"]), i["isURL"], "url_format"


async def do_query(connector, timeout):
    pedding = []

    async def do_url_format(data_, Q, connector, timeout, data_ps={}):
        # data_, dos = await wikidata_linked(Q, {}, session)
        async with aiohttp.ClientSession(connector=connector, trust_env=True, timeout=timeout) as session:
            if Q in ["P856", "P1019", "P1581"]:
                Return
            q_item = get_q(data_["Wikidata_property"]['value'])
            if "formatter_URL" in data_.keys():
                T = False
                query = (get_Q % q_item)
                async for data, size in await sprql_wikidata(query, "SPARQL_"+q_item+".json"):
                    if "http" not in data["ID"]["value"]:
                        url = data_["Wikidata_property"]['value'].replace(
                            "$1", data["ID"]["value"])
                        if do_callback_url_mach(url):
                            continue
                        await url_add2(url, "wikidata", item=Q,  ps=data_ps, session=session,  prop=q_item)

    async def do_url_match_pattern(data_, Q, connector, timeout, data_ps={}):
        async with aiohttp.ClientSession(connector=connector, trust_env=True, timeout=timeout) as session:
            if Q in ["P856", "P1019", "P1581"]:
                return
            q_item = get_q(data_["Wikidata_property"]['value'])
            if "URL_match_pattern" in data_.keys():
                query = (get_Q % q_item)
                async for data, size in await sprql_wikidata(query, "SPARQL_"+q_item+".json"):
                    add_P_mach_url(data["ID"]["value"], q_item)

    async def do_url_get(data_, Q, connector, timeout, data_ps={}):
        async with aiohttp.ClientSession(connector=connector, trust_env=True, timeout=timeout) as session:
            if Q in ["P856", "P1019", "P1581"]:
                return
            q_item = get_q(data_["Wikidata_property"]['value'])
            if "formatter_URL" in data_.keys():
                T = False
                q_item = get_q(data_["Wikidata_property"]['value'])
                query = (get_Q % q_item)
                print("SPARQL_"+q_item+".json")
                async for data, size in await sprql_wikidata(query, "SPARQL_"+q_item+".json"):
                    add_P_mach_url(data["ID"]["value"], q_item)

    async def do_get_ccc(q, query, is_url, mode, connector, timeout):
        pedding = []
        async for data, size in await sprql_wikidata(query, "SPARQL_"+q+".json"):
            bar2.total = size + bar2.total
            if mode == "url_format":
                pedding.append(asyncio.create_task(
                    do_url_format(data, q, connector, timeout)))
            elif mode == "URL_match_pattern":
                pedding.append(asyncio.create_task(
                    (do_url_match_pattern(data, q, connector, timeout))))

            if len(pedding) >= 10:
                await asyncio.wait(pedding)
                pedding = []
            bar2.update()
        if len(pedding) > 0:
            await asyncio.wait(pedding)

    bar = manager.counter(
        desc='GET_ALL_WIKIDATA _TOP REQESTS', total=len(Qs)*3)
    bar2 = manager.counter(desc='GET_ALL_WIKIDATA', total=0)
    pedding2 = []
    for q, query, is_url, mode in C_query():
        pedding2.append(asyncio.create_task(
            do_get_ccc(q, query, is_url, mode, connector, timeout)))
        if len(pedding2) >= 10:
            await asyncio.wait(pedding2)
            pedding2 = []
        bar.update()
    await asyncio.wait(pedding2)
#
